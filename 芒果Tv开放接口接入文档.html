<!DOCTYPE HTML><html><head><style id="wiz_custom_css">html, .wiz-editor-body {font-size: 12pt;}.wiz-editor-body {font-family: Helvetica, "Hiragino Sans GB", "微软雅黑", "Microsoft YaHei UI", SimSun, SimHei, arial, sans-serif;line-height: 1.7;margin: 0 auto;position:relative;padding: 20px 16px;}.wiz-editor-body h1,.wiz-editor-body h2,.wiz-editor-body h3,.wiz-editor-body h4,.wiz-editor-body h5,.wiz-editor-body h6 {margin:20px 0 10px;margin:1.25rem 0 0.625rem;padding: 0;font-weight: bold;}.wiz-editor-body h1 {font-size:20pt;font-size:1.67rem;}.wiz-editor-body h2 {font-size:18pt;font-size:1.5rem;}.wiz-editor-body h3 {font-size:15pt;font-size:1.25rem;}.wiz-editor-body h4 {font-size:14pt;font-size:1.17rem;}.wiz-editor-body h5 {font-size:12pt;font-size:1rem;}.wiz-editor-body h6 {font-size:12pt;font-size:1rem;color: #777777;margin: 1rem 0;}.wiz-editor-body div,.wiz-editor-body p,.wiz-editor-body ul,.wiz-editor-body ol,.wiz-editor-body dl,.wiz-editor-body li {margin:8px 0 0;}.wiz-editor-body blockquote,.wiz-editor-body table,.wiz-editor-body pre,.wiz-editor-body code {margin:8px 0;}.wiz-editor-body .CodeMirror pre {margin:0;}.wiz-editor-body a {word-wrap: break-word;text-decoration-skip-ink: none;}.wiz-editor-body ul,.wiz-editor-body ol {padding-left:32px;padding-left:2rem;}.wiz-editor-body ol.wiz-list-level1 > li {list-style-type:decimal;}.wiz-editor-body ol.wiz-list-level2 > li {list-style-type:lower-latin;}.wiz-editor-body ol.wiz-list-level3 > li {list-style-type:lower-roman;}.wiz-editor-body li.wiz-list-align-style {list-style-position: inside; margin-left: -1em;}.wiz-editor-body blockquote {padding: 0 12px;}.wiz-editor-body blockquote > :first-child {margin-top:0;}.wiz-editor-body blockquote > :last-child {margin-bottom:0;}.wiz-editor-body img {border:0;max-width:100%;height:auto !important;margin:2px 0;padding: 2px;vertical-align:bottom;}.wiz-editor-body table {border-collapse:collapse;border:1px solid #a7afbc;}.wiz-editor-body td,.wiz-editor-body th {padding:4px 8px;border-collapse:collapse;border:1px solid #a7afbc;min-height:28px;word-break:break-word;box-sizing: border-box;}.wiz-editor-body td > div:first-child {margin-top:0;}.wiz-editor-body td > div:last-child {margin-bottom:0;}.wiz-editor-body img.wiz-svg-image {box-shadow:1px 1px 4px #E8E8E8;}.wiz-editor-body .wiz-image-container {margin:0;max-width: 100%;display: inline-flex;flex-direction: column;}.wiz-editor-body .wiz-image-container .wiz-image-title {display:inline-block;text-align: center;color: #a7afbc;line-height: 18px;font-size: 12px;min-height: 18px;width: 100%;white-space: normal;}.wiz-hide {display:none !important;}.wiz-editor-body.wiz-editor-outline {padding-right:0; padding-left:0;}.wiz-editor-body.wiz-editor-outline .outline-container {margin:0; padding:0; line-height:1.5;}.wiz-editor-body.wiz-editor-outline .outline-container div {margin:0;}.wiz-editor-body.wiz-editor-outline .node {margin:0; padding: 0;}.wiz-editor-body.wiz-editor-outline .outline-container > .node {margin-right:24px; margin-left:30px;}.wiz-editor-body.wiz-editor-outline .node.collapsed .children {display:none;}.wiz-editor-body.wiz-editor-outline .node .row {position:relative; padding-left:26px;}.wiz-editor-body.wiz-editor-outline .node .operator-container {width:36px;position:absolute; top:4px; left:-18px;}.wiz-editor-body.wiz-editor-outline .node .operator-bar {position:absolute; top:0; left:0; right:0; bottom:0; display:flex; align-items:center; justify-content:center;}.wiz-editor-body.wiz-editor-outline .node .switch {width:18px; height:18px;display:flex;flex-direction: column;align-items: center;overflow: hidden;}.wiz-editor-body.wiz-editor-outline .node .switch i {font-size:20px;position:relative;left:-1px;top:-1px;}.wiz-editor-body.wiz-editor-outline .node .switch.active {cursor:pointer;color:transparent; transition:transform 200ms ease 0s;}.wiz-editor-body.wiz-editor-outline .node.collapsed .switch.active {transform:rotateZ(-90deg);}.wiz-editor-body.wiz-editor-outline .node .row:hover .switch.active {color:#505F79}.wiz-editor-body.wiz-editor-outline .node .dot {display:flex; align-items:center; justify-content:center; border-radius:100%; width:18px; height:18px;}.wiz-editor-body.wiz-editor-outline .node.collapsed .dot {background-color:rgba(80, 95, 121, .15);}.wiz-editor-body.wiz-editor-outline .node .dot-icon {background-color:#505F79; border-radius:100%; width:6px; height:6px;}.wiz-editor-body.wiz-editor-outline .node .child {margin-left:8px; border-left:1px solid #E6E9ED; padding-left:17px;}.wiz-editor-body.wiz-editor-outline .node .content {flex:1;outline:none; padding:4px 0;}.wiz-editor-body.wiz-editor-outline .node div.content {font-size:1rem;}.wiz-editor-body.wiz-editor-outline .node.complete > .row .content {text-decoration:line-through;color:#A7AFBC;}.wiz-editor-body.wiz-editor-outline .node .notes {outline:none; font-size:.8rem; color:#A7AFBC;}.wiz-editor-body.wiz-editor-outline .node .image {outline:none; padding-top:4px; padding-bottom:4px;}.wiz-editor-body.wiz-editor-outline .outline-container h1,.wiz-editor-body.wiz-editor-outline .outline-container h2,.wiz-editor-body.wiz-editor-outline .outline-container h3,.wiz-editor-body.wiz-editor-outline .outline-container h4,.wiz-editor-body.wiz-editor-outline .outline-container h5,.wiz-editor-body.wiz-editor-outline .outline-container h6 {margin:0;}

html, .wiz-editor-body {
  font-family:'Helvetica Neue';
  font-size:15px;
  background-color:#FFFFFF;
  line-height:1.7;
  color: #000000;
} 
body.wiz-editor-body div, body.wiz-editor-body p, body.wiz-editor-body ul, body.wiz-editor-body ol, body.wiz-editor-body dl, body.wiz-editor-body li {
  margin-top:8px; margin-bottom:8px
}
body, .wiz-editor-body {
  padding-top: 8px !important;
  padding-left: 48px;
  padding-right: 48px;
}
</style></head><body class="wiz-editor-body " data-wiz-document-type="common" style="opacity: 1;" ><h1><font face="Times New Roman">接入指南</font></h1><h1><font face="Times New Roman">Android接入指南</font></h1><p style="color: rgb(34, 34, 34); font-size: 0.933rem;"><strong><font face="Times New Roman">注 1：jCenter 服务将在2021年5月1日之后关停，因此芒果开放sdk 初始发布到 Maven Central</font></strong></p><p style="color: rgb(34, 34, 34); font-size: 0.933rem;"><strong><font face="Times New Roman"></font></strong></p><h3 style="font-size: 1.25rem;"><ul style="color:rgb(34, 34, 34);"><li><h2 style="font-size:1.5rem;"><strong><font face="Times New Roman">下载sdk及API文档</font></strong></h2><div><span data-wiz-span="data-wiz-span" style="font-size:1rem;"><font face="Times New Roman">Android studio环境下，在build.gradle中添加以下依赖即可：</font></span></div></li></ul><font color="#222222" face="-apple-system, system-ui, SF UI Text, Helvetica Neue, PingFang SC, Hiragino Sans GB, Microsoft YaHei UI, Microsoft YaHei, Arial, sans-serif"></font></h3><blockquote style=""><blockquote><blockquote><blockquote><pre style="font-size: 0.8rem;"><pre style="">dependencies <span>{</span><br><pre style="font-family: Menlo;">    implementation <span style="color:#008000;">'io.github.mgtvmobile:authlogin:0.0.3'</span></pre><div>}</div></pre></pre></blockquote></blockquote></blockquote></blockquote><h1 style="font-size: 1.67rem;"></h1><h3 style="font-size: 1.25rem;"><span data-wiz-span="data-wiz-span" style="font-size: 1rem; color: rgb(34, 34, 34);">&nbsp; &nbsp; &nbsp;<span>&nbsp;</span><font face="Times New Roman">&nbsp;&nbsp; 引用Maven Central，<span>在项目的根 build.gradle 文件中, 添加如下代码即可：</span>Android studio环境下，在build.gradle中添加以下依赖即可：</font></span></h3><blockquote style=""><blockquote><blockquote><blockquote><div><pre style="font-size: 0.8rem;">allprojects <span>{<br></span></pre></div></blockquote></blockquote></blockquote><blockquote><blockquote><blockquote><div><pre style="font-family:Menlo;font-size:0.8rem;"><span>    </span>repositories <span>{<br></span></pre></div></blockquote></blockquote></blockquote><blockquote><blockquote><blockquote><div><pre style="font-family:Menlo;font-size:0.8rem;"><span>        </span>mavenCentral();</pre></div></blockquote></blockquote></blockquote><blockquote><blockquote><blockquote><div><pre style="font-family:Menlo;font-size:0.8rem;">    <span>}<br></span></pre></div></blockquote></blockquote></blockquote><blockquote><blockquote><blockquote><div><pre style="font-family:Menlo;font-size:0.8rem;"><span>}</span></pre></div></blockquote></blockquote></blockquote><blockquote><blockquote><blockquote><div><pre style="font-family:Menlo;font-size:0.8rem;">buildscript <span>{<br></span></pre></div></blockquote></blockquote></blockquote><blockquote><blockquote><blockquote><div><pre style="font-family:Menlo;font-size:0.8rem;"><span>    </span>repositories <span>{<br></span></pre></div></blockquote></blockquote></blockquote><blockquote><blockquote><blockquote><div><pre style="font-family:Menlo;font-size:0.8rem;"><span>        </span>mavenCentral()</pre></div></blockquote></blockquote></blockquote><blockquote><blockquote><blockquote><div><pre style="font-family:Menlo;font-size:0.8rem;">    <span>}<br></span></pre></div></blockquote></blockquote></blockquote><blockquote><blockquote><blockquote><div><pre style="font-family:Menlo;font-size:0.8rem;"><span>}</span></pre><pre style="font-family:Menlo;font-size:0.8rem;"><span><br></span></pre></div></blockquote></blockquote></blockquote></blockquote><h3 style=""><ul style="color: rgb(34, 34, 34);"><li style=""><h2 style=""><font face="Times New Roman">代码使用</font></h2><p><span style="" data-wiz-span="data-wiz-span"><font face="Times New Roman" style=""><span data-wiz-span="data-wiz-span" style="font-size: 1rem;">1、AndroiManifest.xml 权限设置</span></font></span></p></li><li style=""><pre style="color: rgb(0, 0, 0); font-family: Menlo; font-size: 0.8rem;"><span style="font-weight: normal;">&lt;<span style="color:#000080;">uses-permission </span><span style="color:#660e7a;">android</span><span style="color:#0000ff;">:name</span><span style="color:#008000;">="android.permission.QUERY_ALL_PACKAGES" </span>/&gt; </span></pre></li><li style=""><pre style="color: rgb(0, 0, 0); font-family: Menlo; font-size: 0.8rem;"><span style="font-weight: normal;">&lt;<span style="color:#000080;">uses-permission </span><span style="color:#660e7a;">android</span><span style="color:#0000ff;">:name</span><span style="color:#008000;">="android.permission.INTERNET" </span>/&gt;</span></pre><pre style="color: rgb(0, 0, 0); font-family: Menlo; font-size: 0.8rem;"></pre></li></ul></h3><h3 style=""></h3><h3 style="text-align: left;"><span style="font-family: &quot;Times New Roman&quot;; color: rgb(34, 34, 34);">&nbsp;<span data-wiz-span="data-wiz-span" style="font-size: 1rem;">&nbsp; &nbsp; &nbsp; &nbsp;2、<span>注册芒果TV</span></span></span></h3><h3 style="text-align: left;"></h3><blockquote style=""><blockquote style=""><blockquote style=""><blockquote style=""><pre style="font-size: 0.8rem;"><pre style=""><span style="color: rgb(34, 34, 34); font-size: 0.933rem;"><font face="Times New Roman">在代码合适的时机向sdk注册你的 appID。（</font></span><span style="color: rgb(34, 34, 34); font-size: 0.933rem;"><font face="Times New Roman">在程序入口 Activity 的 onCreate 回调函数处或其他合适的地方将你的应用 appID注册）</font></span></pre></pre></blockquote></blockquote></blockquote></blockquote><blockquote style=""><blockquote style=""><blockquote style=""><blockquote style=""><pre style="font-family: Menlo; font-size: 0.8rem;"><span><pre style="font-family: Menlo;"><span style="color:#808080;font-style:italic;">// APP_ID 替换为你的应用从官方网站申请到的合法appID<br></span><span style="color:#000080;">private static final </span>String <span style="color:#660e7a;font-style:italic;">APP_ID </span>= <span style="color:#008000;">""</span>;<br><span style="color:#808080;font-style:italic;">// MgtvOepnApi 是第三方app和芒果tv通信的接口<br></span><span style="color:#000080;">private </span>MgtvOpenApi <span style="color:#660e7a;">mMgtvOpenApi</span>;<br><br><span style="color:#808000;">@Override<br></span><span style="color:#000080;">public void </span>onCreate(<span style="color:#808000;">@Nullable </span>Bundle savedInstanceState) {<br>    <span style="color:#000080;">super</span>.onCreate(savedInstanceState);<br>    <span style="color:#660e7a;">mMgtvOpenApi </span>= MgtvOpenApiFactory.<span style="font-style:italic;">create</span>();<br>    <span style="color:#808080;font-style:italic;">// 将应用申请的appID注册<br></span><span style="color:#808080;font-style:italic;">    </span><span style="color:#660e7a;">mMgtvOpenApi</span>.registerApp(<span style="color:#660e7a;font-style:italic;">APP_ID</span>);<br>    <span style="color:#808080;font-style:italic;">// 开启sdk中的log日志<br></span><span style="color:#808080;font-style:italic;">    </span><span style="color:#660e7a;">mMgtvOpenApi</span>.enableLog(<span style="color:#000080;">true</span>);<br>}</pre><pre style="font-family: Menlo;"><br></pre></span></pre><pre style="font-size: 0.8rem;"><font face="Times New Roman"><span data-wiz-span="data-wiz-span" style="font-size: 0.917rem;"><font color="#ff0000"><b>注册成功后，就可以使用MgtvOpenApi来调用芒果TV开放的接口能力</b></font>（当然各种接口能力是否成功，</span></font></pre><pre style="font-size: 0.8rem;"><font face="Times New Roman"><span data-wiz-span="data-wiz-span" style="font-size: 0.917rem;">还取决于您是否在应用创建平台是否申请了对于的能力）</span></font></pre></blockquote></blockquote></blockquote></blockquote><h1></h1><div><hr></div><h1><font face="Times New Roman">芒果tv登录功能</font></h1><h2><font face="Times New Roman">概述</font></h2><div><ul><li><font face="Times New Roman">芒果tv授权登录让芒果tv用户使用芒果tv账号安全登录第三方应用，目前移动应用上的芒果tv登录提供2种方式：</font></li></ul></div><div><font face="Times New Roman">&nbsp; &nbsp; &nbsp; 1、原生登录（芒果tv已安装情况下）</font></div><div><font face="Times New Roman">&nbsp; &nbsp; &nbsp; 2、web登录（在芒果tv未安装情况下的登录方式）</font></div><div><ul><li><font face="Times New Roman">权限开放：目前只开放用户基础信息（<font color="#92d050">basic</font>）</font></li></ul></div><h2><span style="font-weight: bold;"><font face="Times New Roman">快速接入</font></span></h2><h3><font face="Times New Roman">1、创建应用</font></h3><div><font face="Times New Roman">要在您的应用中使用芒果tv开放的接口能力，您需要创建一个应用以获取AppID(此为您应用的唯一标识），并且</font></div><div><font face="Times New Roman">可以申请开通开放产品下的各种使用权限，通过AppID您的应用才能调用芒果开放的接口能力。申请方式详见：<a href="https://www.yuque.com/docs/share/a1b2464e-7a66-4252-834d-79f28426163a#dUk3c">创建应用</a></font></div><h3>2<font face="Times New Roman">、使用授权登录</font></h3><div><pre style="font-size: 0.8rem;"><font face="Times New Roman"><span data-wiz-span="data-wiz-span" style="font-size: 1rem;">在集成芒果开放接口sdk 以及完成创建应用前提下，接下来只需要在您应用的界面中使用对应的开放能力，比如：登录</span></font></pre><pre style="font-size: 0.8rem;"><font face="Times New Roman"><span data-wiz-span="data-wiz-span" style="font-size: 1rem;">在未安装芒果Tv应用情况下，sdk中默认会使用web网页登录授权， 代码示例如下：</span></font></pre><pre style="font-size: 0.8rem;"><font face="Times New Roman"><span data-wiz-span="data-wiz-span" style="font-size: 1rem;"><pre style="font-family: Menlo; font-size: 0.8rem;"><span style="color:#808080;font-style:italic;">/**<br></span><span style="color:#808080;font-style:italic;"> * 原生登录<br></span><span style="color:#808080;font-style:italic;"> */<br></span><span style="color:#000080;">private void </span>loginMgtv() {<br>    MgtvAuthRequest request = <span style="color:#000080;">new </span>MgtvAuthRequest();<br>    <span style="color:#808080;font-style:italic;">// 当前只开发basic权限<br></span><span style="color:#808080;font-style:italic;">    </span>request.<span style="color:#660e7a;">scope </span>= MgtvAuthScope.<span style="color:#660e7a;font-style:italic;">BASIC</span>;<br>    login(request);<br>}<br><br><span style="color:#808080;font-style:italic;">/**<br></span><span style="color:#808080;font-style:italic;"> * 网页登录<br></span><span style="color:#808080;font-style:italic;"> */<br></span><span style="color:#000080;">private void </span>loginWebAuth() {<br>    MgtvAuthRequest request = <span style="color:#000080;">new </span>MgtvAuthRequest();<br>    request.<span style="color:#660e7a;">scope </span>= MgtvAuthScope.<span style="color:#660e7a;font-style:italic;">BASIC</span>;<br>    request.<span style="color:#660e7a;">isWebAuth </span>= <span style="color:#000080;">true</span>;<br>    login(request);<br>}<br><br><span style="color:#808080;font-style:italic;">/**<br></span><span style="color:#808080;font-style:italic;"> * 登录<br></span><span style="color:#808080;font-style:italic;"> * </span><span style="color:#808080;font-style:italic;">@param </span><span style="color:#3d3d3d;font-style:italic;">request </span><span style="color:#808080;font-style:italic;">认证请求<br></span><span style="color:#808080;font-style:italic;"> */<br></span><span style="color:#000080;">private void </span>login(MgtvAuthRequest request) {<br>    <span style="color:#660e7a;">mMgtvOpenApi</span>.login(getActivity(), request, <span style="color:#000080;">new </span>MgtvAuthListener() {<br>        <span style="color:#808000;">@Override<br></span><span style="color:#808000;">        </span><span style="color:#000080;">public void </span>onSuccess(String authCode) {<br>            <span style="color:#808080;font-style:italic;">// 授权登录成功返回的authCode，接下来使用该code去向server换取token<br></span><span style="color:#808080;font-style:italic;">        </span>}<br>        <span style="color:#808000;">@Override<br></span><span style="color:#808000;">        </span><span style="color:#000080;">public void </span>onError(<span style="color:#000080;">int </span>errorCode, String errorMessage) {<br>           <span style="color:#808080;font-style:italic;">// 授权登录失败<br></span><span style="color:#808080;font-style:italic;">        </span>}<br>        <span style="color:#808000;">@Override<br></span><span style="color:#808000;">        </span><span style="color:#000080;">public void </span>onCancel() {<br>            <span style="color:#808080;font-style:italic;">// 用户取消授权登录流程<br></span><span style="color:#808080;font-style:italic;">        </span>}<br>    });<br>}</pre><pre style="font-family: Menlo; font-size: 0.8rem;"><br></pre></span></font></pre></div><h3 style="font-size: 1.25rem;">3<font face="Times New Roman">、使用authCode换取<span>access_token</span></font></h3><div><font face="Times New Roman">在第2步授权成功的前提下，使用authCode请求服务换取access_token, 具体细节详见：<a href="https://www.yuque.com/docs/share/a1b2464e-7a66-4252-834d-79f28426163a#88n8U">颁发令牌</a></font></div><div style=""><h3 style="font-size: 1.25rem;">4<font face="Times New Roman">、使用access_token获取用户信息</font></h3></div><div><span style="font-family: &quot;Times New Roman&quot;;">在拿到access_token前提下，获取用户信息, 具体细节详见：<a href="https://www.yuque.com/docs/share/a1b2464e-7a66-4252-834d-79f28426163a#0frMT://">获取用户信息</a></span></div><h2><span style="font-family: &quot;Times New Roman&quot;; font-weight: bold;">FAQ</span></h2><div><br></div><div><br></div></body></html>